<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="homePg.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=BBH+Sans+Bartle&family=Instrument+Serif:ital@0;1&family=Quicksand:wght@300..700&display=swap" rel="stylesheet">
    <title>Home</title>
</head>
<body>
    <main class="container">
        <section id="headerSection">
                <a href="homePg.html"><img src="Assets/rendezvous logo.png" alt="Company Logo" id="logoImage" height="100px" width="100px"></a>
                <nav>
                    <a href="jetPg.html"><button>JETS</button></a>
                    <a href="watchPg.html"><button>WATCHES</button></a>
                    <a href="#contact"><button>ABOUT</button></a>
                    <a href="loginPg.html" ><button id="loginBtn">Login</button></a>
                </nav>
                <div>
                    <div class="dropdown">
                        <p id="greeting"></p>
                        <div class="dropdown-Content">
                            <a href="#" id="logoutBtn" onclick="logout()">Logout</a>
                            <a href="#" id="invoiceBtn" onclick="getUserInvoices()">Invoices</a>
                        </div>
                    </div>
                    <a href="cartPg.html"><img src="Assets/cart icon.png" width="30px" height="30px"></a>
                    <span id="cartCount" class="hidden"></span>
                </div>
        </section>
        <section id="welcomeSection">
            <div id="invoicePopup" class="invoice-modal">
                <div class="invoice-modal-content">
                    <button type="button" id="closeInvoicePopup" class="close-btn">X</button>
                    <h2>Your Invoices</h2>
                    <div id="invoiceListContainer">
                    <!-- Invoices will be injected here -->
                    </div>
                </div>
            </div>

            <div id="splitBackgroud">
                <div id="leftSide"></div>
                <div id="rightSide"></div>
            </div>
            <div id="welcomeText">
                <h1>Where Time Meets The Sky</h1>
                <p>Experience Timeless Luxury - from precious timepieces to private travel</p>
                <div id="buttonContainer">
                    <a href="jetPg.html"><button>EXPLORE JETS</button></a>
                    <a href="watchPg.html"><button>SHOP WATCHES</button></a>
                </div>
            </div>
        </section>

        <section id="overview">
            <h2>About Rendezvous</h2>
            <p>At Rendezvous, we specialize in offering an exclusive selection of luxury watches and private jets. Our curated collection features timepieces from the world's most prestigious brands, known for their craftsmanship, innovation, and timeless design. Whether you're a seasoned collector or a first-time buyer, our expert team is here to guide you through our offerings and help you find the perfect watch that suits your style and needs.</p>
            <p>In addition to our exquisite watch collection, we provide access to a fleet of private jets for those seeking unparalleled travel experiences. Our private jet services cater to discerning clients who value privacy, comfort, and convenience. From short domestic flights to international journeys, we ensure that every aspect of your travel is handled with the utmost care and professionalism.</p>
            <p>Discover the epitome of luxury with Rendezvous - where time meets the sky.</p>
        </section>

        <footer id="contact">
            <div id="info">
                <p>Contact us:</p>
                <p><a href="mailto:seangroves9@gmail.com">Email: Rendezvous@gmail.com</a></p>
                <p>Phone: +44 1234 567890</p>
            </div>
            <div>
            <a href="https://www.facebook.com/"><img class="footericons" src="Assets/fbIconBW.png" alt="Facebook Icon"></a>
            <a href="https://www.instagram.com/"><img class="footericons" src="Assets/igIconBW.png" alt="Instagram Icon"></a> 
            <a href="https://x.com/"><img class="footericons" src="Assets/twitterIconBW.png" alt="Twitter Icon"></a> 
            </div>

            <p>Sean Groves #2303829</p>
            <p><a href="mailto:seanmgroves@students.utech.edu.jm">Email: seanmgroves@students.utech.edu.jm</a></p>
            <p>CIT2011 WED@10pm</p>
            <p>Web Programming Individual Assignment 2</p>
            <p>&copy; 2025 Redezvous. All rights reserved.</p>
        </footer>

    </main>


    
    <script>

       function checkLoginStatus() {
            const activeUser = JSON.parse(localStorage.getItem("ActiveUser"));
            const greeting = document.getElementById("greeting");
            const loginBtn = document.getElementById("loginBtn");
            const dropdown = document.querySelector(".dropdown");

            if (activeUser) {
                // Show user name
                greeting.textContent = `Welcome, ${activeUser.firstName}!`;

                // Hide login button
                loginBtn.style.display = "none";

                // Show dropdown
                dropdown.style.display = "inline-block";
            } else {
                // Not logged in
                greeting.textContent = "";

                loginBtn.style.display = "inline-block";
                dropdown.style.display = "none";
            }
        }


       function logout() {
            localStorage.removeItem("ActiveUser");
            alert("You have been logged out.");
            window.location.reload();
        }

        function updateCartCount(count) {
            const cartCount = document.getElementById("cartCount");

            if (!cartCount) return;

            if (count === 0) {
                cartCount.style.display = "none";
                cartCount.classList.add("hidden");
            } else {
                cartCount.textContent = count;
                cartCount.style.display = "inline-block";
                cartCount.classList.remove("hidden");
            }
        }

        function getUserInvoices() {
                const activeUser = JSON.parse(localStorage.getItem("ActiveUser"));
                const popup = document.getElementById("invoicePopup");
                const listContainer = document.getElementById("invoiceListContainer");

                if (!activeUser) {
                    alert("You must be logged in to view invoices.");
                    return;
                }

                const allUsers = JSON.parse(localStorage.getItem("RegistrationData")) || [];
                const user = allUsers.find(u => u.trn === activeUser.trn);

                // Clear old results
                listContainer.innerHTML = "";

                if (!user || !user.invoices || user.invoices.length === 0) {
                    listContainer.innerHTML = "<p>No invoices found.</p>";
                } else {
                    user.invoices.forEach((invoice, index) => {
                        const card = document.createElement("div");
                        card.className = "invoice-card";
                        card.innerHTML = `
                            <button class="invoice-btn" data-id="${invoice.invoiceNumber}">
                                <p><strong>Invoice #${index + 1}</strong></p>
                                <p><strong>Date:</strong> ${new Date(invoice.date).toLocaleDateString()}</p>
                                <p><strong>Total:</strong> $${invoice.total.toFixed(2)}</p>
                            </button>
                        `;
                        listContainer.appendChild(card);
                        card.querySelector(".invoice-btn").addEventListener("click", function (e) {
                            const invoiceId = e.target.closest(".invoice-btn").getAttribute("data-id");
            
                            // Save the selected invoice number
                            localStorage.setItem("selectedInvoice", invoiceId);
            
                            // Redirect to invoice page
                            window.location.href = "invoicePg.html";
                        });
                    });
                }

                // Show popup
                popup.style.display = "flex";
            }


            document.getElementById("closeInvoicePopup").onclick = function() {
                document.getElementById("invoicePopup").style.display = "none";
            };

        window.onclick = function(event) {
            const popup = document.getElementById("invoicePopup");
            if (event.target === popup) {
                popup.style.display = "none";
            }
        };

        window.onload = function(){
            const cart = JSON.parse(localStorage.getItem('cart')) || [];
            updateCartCount(cart.length);
            checkLoginStatus();
        };


    </script>

   
        <style>
            .invoice-modal {
                display: none;
                position: fixed;
                z-index: 9999;
                left: 0;
                top: 0;
                width: 100%;
                height: 100%;
                background: rgba(0,0,0,0.5);
                justify-content: center;
                align-items: center;
            }
            .invoice-modal-content {
                background: white;
                color: black;
                width: 400px;
                max-height: 70vh;
                overflow-y: auto;
                padding: 20px;
                border-radius: 10px;
                font-family: "Quicksand", sans-serif;
                box-shadow: 0 4px 20px rgba(0,0,0,0.4);
            }
            .close-btn {
                float: right;
                cursor: pointer;
                font-size: 24px;
                background: none;
                border: none;
            }
            .invoice-card {
                background-color:transparent;
                color: black;
                padding: 0;
                margin-bottom: 12px;
            }
           
            .invoice-btn {
                width: 100%;
                background: #ff0505;
                border: none;
                text-align: left;
                padding: 12px;
                border-radius: 8px;
                cursor: pointer;
                border-left: 4px solid #555;
                font-family: "Quicksand", sans-serif;
                color: #000;
            }

            .invoice-btn:hover {
                background: #ececec;
            }
        </style>

</body>
</html>